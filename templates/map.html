{% extends 'base.html' %}
{% load staticfiles %}

{% block head %}
    <link rel="stylesheet" href="{% static 'leaflet/leaflet.css' %}" />

    <style>
        #profiles path.y1 {
            stroke: {{track_color}};
        }
    </style>

    <script type="text/javascript" src="{% static 'leaflet/leaflet.js' %}" ></script>
    <script type="text/javascript" src="{% static 'd3.v3.min.js' %}" ></script>
    <script type="text/javascript" src="{% static 'map.js' %}" ></script>

    <script type="text/javascript">
        _tiles_url = "{{tiles_url}}";
        _tiles_opt = {{tiles_opt|safe}};
        _track_color = "{{track_color}}";
        $(document).ready(function() {setTimeout("init();", 100);});
    </script>

    {% verbatim %}
    <script id="navigation-template" type="text/x-handlebars-template">
        {{#each data}}
        <li class="dropdown">
            <a class="dropdown-toggle" data-toggle="dropdown" href="#">{{year}}<b class="caret"></b></a>
            <ul class="dropdown-menu">
            {{#each tracks}}
            <li>
                <a class="load-track" href="#{{id}}">
                {{#if name}}
                {{name}} - {{prettifyDate timestamp}}
                {{else}}
                {{prettifyDate timestamp}}
                {{/if}}
                </a>
            </li>
            {{/each}}
            </ul>
        </li>
        {{/each}}
    </script>

    <script id="properties-template" type="text/x-handlebars-template">
        <li class="dropdown">
            <a class="dropdown-toggle" data-toggle="dropdown" href="#">Properties<b class="caret"></b></a>
            <div class="dropdown-menu">
            <table>
                {{#if total_time}}
                <tr>
                    <td>Total time</td>
                    {{#with total_time}}
                    <td>{{hours}}:{{minutes}}:{{seconds}}</td>
                    {{/with}}
                </tr>
                {{/if}}

                {{#if total_dist}}
                <tr>
                    <td>Distance</td>
                    <td>{{total_dist}} km</td>
                </tr>
                {{/if}}

                {{#if mean_speed}}
                <tr>
                    <td>&#216; Speed</td>
                    <td>{{mean_speed}} km/h</td>
                </tr>
                {{/if}}

                {{#if maximum_speed}}
                <tr>
                    <td>Max. Speed</td>
                    <td>{{maximum_speed}} km/h</td>
                </tr>
                {{/if}}

                {{#if mean_cad}}
                <tr>
                    <td>&#216; Cadence</td>
                    <td>{{mean_cad}}</td>
                </tr>
                {{/if}}

                {{#if maximum_cad}}
                <tr>
                    <td>Max. Cadence</td>
                    <td>{{maximum_cad}}</td>
                </tr>
                {{/if}}
            </table>
            </div>
        </li>
    </script>

    <script id="profiles-template" type="text/x-handlebars-template">
        <li class="dropdown">
            <a class="dropdown-toggle" data-toggle="dropdown" href="#">Profiles<b class="caret"></b></a>
            <div id="profiles-canvas" class="dropdown-menu"></div>
        </li>
    </script>
    {% endverbatim %}
{% endblock %}

{% block content %}
    <div id="map"></div>
{% endblock %}
